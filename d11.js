const input = `.....................#..........#......#............#........................................#..............................................
#.........................#...................................#...................#.........................................................
......................................................................#......#...................................#..........#...............
........................................................................................................................................#...
......#............................#.......................#................................................................................
........................#......................#.........................................................#..................................
.............#................#.....................#................................#.................................#....................
...............................................................................................................#............................
..........................................#........................#...............................................................#........
#...............................................................................#...............#..................#......#.................
.........#................................................................#..............#............#.....................................
...................................................#........................................................................................
.....#.............#............................................#.........................................#...................#.............
.......................................................................................................................#....................
..........................................#.............#......................................#.......................................#....
..........#..........................#........................................................................#.............................
..........................................................................#..........................#......................................
...#..................#..........................#......................................#...................................................
.................#..........................#....................................................#...........................#.......#......
............................#.................................#.......#...........................................#.........................
.......#.........................................................................#..........................................................
...........................................................................#..........................#...................................#.
...............................................................................................#...............#..................#.........
............................................................................................................................................
.............#...........................................#.....#........................#................................#..................
.#..................................................#...................#...........................#.......#...............................
............................#................................................................#..........................................#...
.........#....................................#.............#....................................................#..........................
...................#...................#............................#.............................................................#.........
.........................#..................................................................................................................
...................................................................................#........................................#...............
.......#...........................................#.........................................................#..............................
..........................................#......................#............#.............#........................................#......
................................#.......................................................................#...................................
....#.................................#..................................................................................................#..
............................#...............................................................................................................
..............#........#.............................................#......................................................................
....................................................#.......#...........................................................#...................
..........#........#...............................................................#..............#.........................................
..............................................#..............................................#..................#...........................
.................................#............................................#...........................#................................#
..#...................................#.............................................................................#................#......
............#.......................................................................................#........................#..............
.................................................#..............#......#.............#......................................................
................................................................................#...........................................................
...........................................#..........#....................................................#......#.........................
........................#.......................................................................................................#...........
..................#...............#...........................................................#.............................................
.....#.....#.......................................#..........................................................#.........................#...
#......................................................................#..................#.........#.......................................
......................#..............#...........................#..........................................................................
..............................#...............#.............#..............................................#.......#........#...............
............................................................................................................................................
..............#.....................................#..................................#...............#..........................#.........
..#........................#................................................................................................................
................................................................#...........................#..................#............................
.........#...................................................................#..........................................#............#......
..................#........................#................................................................................................
.................................................#.......................#......................#.........................................#.
............................................................................................................................................
..#...........#.............#....................................................................................#..........................
.....................#..............................................#.......................................................................
.....................................#.............................................#......#.................#...........................#...
..........................................#..........#..................................................................#...................
........................#........#...............................#.................................#...........................#............
........#.................................................#.................................................................................
............................................................................................................................................
#.................#...................#..........#..................#.....#........................................................#........
............#.................................................................................................#.............................
..........................#.........................................................#.......................................................
...................................#.....................................................#..........#.......................................
............................................#..................#..................................................#.........................
..............#..........................................#............#........................#..........................................#.
......#.................#........................................................#..........................................................
...................................................#.......................................#..................................#.....#.......
.........................................#..................................................................................................
.....................#.........................#......................................#............#.....................#..................
............................#......#.........................................#......................................#.......................
............................................................................................................................................
...........#......................................#.................#.............#.........................................................
.............................................#..........#..................................#..................#.............................
..................#........................................................#............................#.............#.....................
............................................................................................................................................
............................................................................................................................................
.............#.......................#......................................................................................................
....................#......................#................................................#...............................................
........................................................#.............#........#.....................................................#......
.....#........................................................#..........................................#......................#...........
..........#..............#......#.........................................#......................................#..........................
..................................................#.........................................................................................
.#...................................................................................................#.......#.........#.................#..
.....................................#.........................................................#............................................
......................#......................#..................................#...........................................................
..........................................................................................................................#...........#.....
.................................#.........................#........................................................#.......................
...........#....................................................#.......................#..................#....................#..........#
...................................................#.................#......................................................................
#..........................#........#.....................................#.........#..........#............................................
...........................................................................................................................#...........#....
....................#.........................#.................................#...........................................................
.......#............................................................................................#.....#.................................
......................................................#........#........#....................#............................................#.
........................................#...................................................................................................
.........................#.....#...........................#.......#...............#..........................#.............................
.............#..............................#.........................................................................#.....................
.................................................#......................................#...................................................
................................................................................................#...........................................
....................#.............................................................................................................#.........
#.........................................#...................#..............................................#..............................
....................................................................#...........#....................................#......................
..............#........#.......................#......#.....................................#.........#.....................................
.....................................#....................................#...............................................................#.
...................#.......................................#..........................#......................................#..............
........#.....................#.............................................................................................................
.........................#..............................................................................#..........#........................
#...............................................................#.................#.........................................................
.......................................#.............................#............................#.......................#...........#.....
.................................................#..........................................................#..............................#
.........................................................#....................................................................#.............
.........................................................................................#..................................................
......#.........#......#...............................................................................#....................................
...........................................#........................#................#......................................................
............................#.......#.................................................................................#.............#.......
...................#.............................................................................................#..........#...............
...............................................#.........#.........................................#......#.................................
...............................................................................#................................................#...........
...............................................................#....................#........#........................................#.....
.........#........................................#.........................................................................................
.......................................................#................#..........................................#.........#..............
...................................#....................................................#..............#....................................
.................#......................#.....#.............................................................................................
#.......................#.......................................................#..........................................................#
...............................................................................................................#..........#.................
....................#.............................#...........................................#.....#................#......................
.....................................#.....................#.............#............................................................#.....
....#.........#....................................................#........................................................................
.................................................................................#..........................................................
............................#.........................................................................#.....................................
........#............................................#.....................................#.................................#..............
......................#................#...............................#......#............................#................................`

const input2 = `...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#....`


function getAllPair(arr){
  const pairs = []
  for( let i=0; i<arr.length; i++ ){
    for( let j=i+1; j<arr.length; j++ ){
      pairs.push([arr[i], arr[j]])
    }
  }
  return pairs

}

function getDistance(p1, p2){
  return Math.abs(p1.x - p2.x) + Math.abs(p1.y - p2.y)
}

const EXPANSION = 1000000

class Universe{

  constructor(input){
    this.grid = input.split(/[\n\r]+/g).map(row => row.split(''))
    this.width = this.grid[0].length
    this.height = this.grid.length
  }

  isRowEmpty(y){
    return this.grid[y].every(v => v === '.')
  }

  isColEmpty(x){
    return this.grid.every(row => row[x] === '.')
  }

  insertEmptyRow(y){
    this.grid.splice(y, 0, new Array(this.width).fill('.'))
    this.height++
  }

  insertEmptyCol(x){
    this.grid.forEach(row => row.splice(x, 0, '.'))
    this.width++
  }

  expendEmptyColsAndRows(){
    for( let y=this.height-1; y>=0; y-- ){
      if( this.isRowEmpty(y) ){
        this.insertEmptyRow(y)
      }
    }

    for( let x=this.width-1; x>=0; x-- ){
      if( this.isColEmpty(x) ){
        this.insertEmptyCol(x)
      }
    }
  }

  findAllGalaxies(){
    const galaxies = []
    for( let y=0; y<this.height; y++ ){
      for( let x=0; x<this.width; x++ ){
        if( this.grid[y][x] === '#' ){
          galaxies.push({x, y})
        }
      }
    }
    return galaxies
  }

  getDistance(p1, p2){
    let d = 0;

    const minX = Math.min(p1.x, p2.x)
    const maxX = Math.max(p1.x, p2.x)
    const minY = Math.min(p1.y, p2.y)
    const maxY = Math.max(p1.y, p2.y)

    for( let x = minX+1 ; x <= maxX; x++ ){
      if( this.isColEmpty(x) ){
        d += EXPANSION
      } else{
        d++
      }
    }

    for( let y = minY+1 ; y <= maxY; y++ ){
      if( this.isRowEmpty(y) ){
        d += EXPANSION
      } else{
        d++
      }
    }
    return d
  }

  print(){
    console.log(this.grid.map(row => row.join('')).join('\n'))
    console.log("---")
  }
}

//part 1
// const universe = new Universe(input)
// // universe.print()

// universe.expendEmptyColsAndRows()
// // universe.print()

// const galaxies = universe.findAllGalaxies()
// // console.log(galaxies)

// const pairs = getAllPair(galaxies)
// // console.log(pairs)

// const distances = pairs.map(pair => getDistance(pair[0], pair[1]))
// // console.log(distances)

// const sum = distances.reduce((acc, v) => acc + v, 0)
// console.log(sum)

//part 2
const universe = new Universe(input)
// universe.print()

const galaxies = universe.findAllGalaxies()
// console.log(galaxies)

const pairs = getAllPair(galaxies)
// console.log(pairs)

// console.log(pairs[0][0], pairs[0][1])
// console.log(universe.getDistance(pairs[0][0], pairs[0][1]))
// Z

const distances = pairs.map(pair => universe.getDistance(pair[0], pair[1]))
// console.log(distances)

const sum = distances.reduce((acc, v) => acc + v, 0)
console.log(sum)
